<h1 class="text-2xl font-bold mb-4">Administrar pedidos</h1>

@if (loading) {
  <p class="text-gray-600">Cargando pedidos...</p>
} @else if (error) {
  <p class="text-red-600">{{ error }}</p>
} @else {
  @if (orders.length === 0) {
    <p class="text-gray-600">No hay pedidos registrados.</p>
  } @else {
    <div class="overflow-auto border rounded-lg">
      <table class="min-w-full text-sm">
        <thead class="bg-gray-100">
          <tr>
            <th class="px-3 py-2 text-left">ID</th>
            <th class="px-3 py-2 text-left">Usuario</th>
            <th class="px-3 py-2 text-right">Total</th>
            <th class="px-3 py-2 text-left">Estado</th>
            <th class="px-3 py-2 text-left">Creado</th>
          </tr>
        </thead>
        <tbody>
          @for (o of orders; track o.id) {
            <tr class="border-t">
              <td class="px-3 py-2">#{{ o.id }}</td>
              <td class="px-3 py-2">
                {{ o.user?.email || 'N/A' }}
              </td>
              <td class="px-3 py-2 text-right">
                {{ o.totalAmount | number: '1.2-2' }}
              </td>
              <td class="px-3 py-2">
                <mat-form-field appearance="outline" class="w-40">
                  <mat-select
                    [value]="o.status"
                    (selectionChange)="onStatusChange(o, $event.value)"
                    [disabled]="updatingOrderId === o.id"
                  >
                    @for (opt of statusOptions; track opt.value) {
                      <mat-option [value]="opt.value">
                        {{ opt.label }}
                      </mat-option>
                    }
                  </mat-select>
                </mat-form-field>
              </td>
              <td class="px-3 py-2">
                {{ o.createdAt | date: 'short' }}
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
}
